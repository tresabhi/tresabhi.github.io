---
import { Box, Flex, Grid, Link, Text } from "@radix-ui/themes";
import ResponsiveImage from "../components/ResponsiveImage.astro";
import { content } from "../core/content";
import BaseLayout from "../layouts/BaseLayout.astro";

const filtered = content.filter((post) => !post.frontMatter.draft);
---

<style>
  .post .wrapper {
    background-color: var(--gray-3);
    overflow: hidden;
    height: 100%;
  }

  .post .wrapper .hero-wrapper {
    aspect-ratio: 2 / 1;
    position: relative;
  }

  .post .wrapper .hero-wrapper .hero {
    background-size: cover;
    background-position: center;
    width: 100px;
    height: 100px !important;
    position: absolute;
    top: 0;
    left: 0;
  }

  .post .wrapper .title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .post .wrapper .description {
    max-height: 6rem;
    overflow: hidden;
    position: relative;
  }

  .post .wrapper .description .cover {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(transparent, var(--gray-3));
  }
</style>

<BaseLayout maxWidth="80rem">
  <Grid
    py="4"
    columns={{
      initial: "repeat(auto-fill, minmax(6rem, 1fr))",
      sm: "repeat(auto-fill, minmax(24rem, 1fr))",
    }}
    flow="dense"
    gap="5"
  >
    {
      filtered.map((post) => {
        return (
          <Link
            underline="none"
            className="post"
            color="gray"
            highContrast
            href={`/${post.slug}`}
          >
            <Flex direction="column" className="wrapper">
              <Box className="hero-wrapper">
                {post.frontMatter.hero && (
                  <ResponsiveImage
                    class:list="hero-wrapper"
                    src={post.frontMatter.hero}
                    alt={`Hero image for the article "${post.title}"`}
                  />
                )}
              </Box>

              <Flex direction="column" gap="3" p="4">
                <Text className="title" size="5" weight="medium">
                  {post.title}
                </Text>
                <Box className="description">
                  <Text>{post.description}</Text>
                  <Box className="cover" />
                </Box>
              </Flex>
            </Flex>
          </Link>
        );
      })
    }
  </Grid>
</BaseLayout>
